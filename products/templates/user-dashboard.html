{% extends "base.html" %}
{% load static %}

{% block content %}
    <h2>Welcome, {{ request.user.username }}</h2>

    <!-- Display User Orders -->
    <h3>Your Orders</h3>
    <ul>
        {% if orders %}
            {% for order in orders %}
                {% if order.product %}
                    <li>
                        <strong>{{ order.product.name }}</strong> - Quantity: {{ order.quantity }}
                        <!-- Product Image (Assuming the 'image' field contains the image URL) -->
                        <br>
                        <img src="{{ order.product.image.url }}" alt="{{ order.product.name }}" style="width:100px;height:auto;">
                        <!-- Product Description -->
                        <p>{{ order.product.description }}</p>
                    </li>
                {% else %}
                    <li>Unknown product - Quantity: {{ order.quantity }}</li>
                {% endif %}
            {% endfor %}
        {% else %}
            <li>You have no orders.</li>
        {% endif %}
    </ul>

    <!-- Display Products Available for Ordering -->
    <h3>Products</h3>
    <ul>
        {% if products %}
            {% for product in products %}
                <li>
                    <strong>{{ product.name }}</strong> - {{ product.price }} USD
                    <!-- Product Image -->
                    <br>
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" style="width:100px;height:auto;">
                    <!-- Product Description -->
                    <p>{{ product.description }}</p>
                    <form method="POST" action="{% url 'make-order' %}" style="display:inline;">
                        {% csrf_token %}
                        <input type="hidden" name="product_id" value="{{ product.id }}">
                        <input type="number" name="quantity" min="1" max="{{ product.stock_quantity }}" value="1" required>
                        <button type="submit" class="btn btn-primary">Order Now</button>
                    </form>
                </li>
            {% endfor %}
        {% else %}
            <li>No products available for ordering.</li>
        {% endif %}
    </ul>

    <a href="{% url 'product-list' %}">View All Products</a>
    <a href="{% url 'user-dashboard' %}">User Dashboard</a>
{% endblock %}
